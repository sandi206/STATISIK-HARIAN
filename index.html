<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STATISTIK HARIAN</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script> <!-- Added xlsx library -->
</head>
<body>
    <header>
        <h1>DATA STATISTIK HARIAN</h1>
    </header>

    <div class="container">
        <form id="attendanceForm">
            <!-- Input Tanggal Penginputan -->
            <label for="inputDate">Tanggal Penginputan:</label>
            <input type="date" id="inputDate" name="inputDate" required>

            <!-- Input ID Karyawan -->
            <label for="employeeId">ID Karyawan:</label>
            <input type="text" id="employeeId" name="employeeId" placeholder="Masukkan ID Karyawan" required>

            <label for="PT">PT</label>
            <select id="division" name="PT">
                <option value="PT A">CSP</option>
                <option value="PT B">LHMI</option>
                <option value="PT C">SMI</option>
            </select>

            <label for="department">Departemen</label>
            <select id="departemen" name="Departemen">
                <option value="dept A">PERAWATAN 1</option>
                <option value="dept B">PERAWATAN 2</option>
                <option value="dept C">PERAWATAN 3</option>
                <option value="dept D">Lainnya</option>
            </select>

            <label for="employeeDivision">Divisi:</label>
            <select id="employeeDivision" name="division">
                <option value="Divisi A">DESULFURISASI</option>
                <option value="Divisi B">ALAT</option>
                <option value="Divisi C">HSE</option>
                <option value="Divisi D">Lainnya</option>
            </select>

            <label for="team">Nama Regu:</label>
            <input type="text" id="team" name="team" placeholder="Masukkan Nama Regu dan Divisi jika tidak ada dalam list" required>

            <!-- Tabel untuk Jenis Shift dan Absensi -->
            <h3>Jenis Shift dan Absensi</h3>
            <table id="shiftTable">
                <thead>
                    <tr>
                        <th>Jenis Shift</th>
                        <th>Hadir</th> 
                        <th>Absen Tunda</th>
                        <th>Sakit</th>
                        <th>Izin</th>
                        <th>CFV</th>
                        <th>CL</th>
                        <th>CT</th>
                        <th>OFF</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Shift Reguler</td>
                        <td><input type="number" name="shiftRegulerAbsen" min="0" step="1"></td> 
                        <td><input type="number" name="shiftRegulerTunda" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerSakit" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerIzin" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerCFV" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerCL" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerCT" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerOFF" min="0" step="1"></td>
                    </tr>
                    <tr>
                        <td>3 Shift 4 Regu</td>
                        <td><input type="number" name="shift34Absen" min="0" step="1"></td>
                        <td><input type="number" name="shift34Tunda" min="0" step="1"></td>
                        <td><input type="number" name="shift34Sakit" min="0" step="1"></td>
                        <td><input type="number" name="shift34Izin" min="0" step="1"></td>
                        <td><input type="number" name="shift34CFV" min="0" step="1"></td>
                        <td><input type="number" name="shift34CL" min="0" step="1"></td>
                        <td><input type="number" name="shift34CT" min="0" step="1"></td>
                        <td><input type="number" name="shift34OFF" min="0" step="1"></td>
                    </tr>
                    <tr>
                        <td>3 Shift 3 Regu</td>
                        <td><input type="number" name="shift33Absen" min="0" step="1"></td>
                        <td><input type="number" name="shift33Tunda" min="0" step="1"></td>
                        <td><input type="number" name="shift33Sakit" min="0" step="1"></td>
                        <td><input type="number" name="shift33Izin" min="0" step="1"></td>
                        <td><input type="number" name="shift33CFV" min="0" step="1"></td>
                        <td><input type="number" name="shift33CL" min="0" step="1"></td>
                        <td><input type="number" name="shift33CT" min="0" step="1"></td>
                        <td><input type="number" name="shift33OFF" min="0" step="1"></td>
                    </tr>
                    <tr>
                        <td>2 Shift 3 Regu</td>
                        <td><input type="number" name="shift23Absen" min="0" step="1"></td>
                        <td><input type="number" name="shift23Tunda" min="0" step="1"></td>
                        <td><input type="number" name="shift23Sakit" min="0" step="1"></td>
                        <td><input type="number" name="shift23Izin" min="0" step="1"></td>
                        <td><input type="number" name="shift23CFV" min="0" step="1"></td>
                        <td><input type="number" name="shift23CL" min="0" step="1"></td>
                        <td><input type="number" name="shift23CT" min="0" step="1"></td>
                        <td><input type="number" name="shift23OFF" min="0" step="1"></td>
                    </tr>
                    <tr>
                        <td>12 Jam Roster</td>
                        <td><input type="number" name="shift12Absen" min="0" step="1"></td>
                        <td><input type="number" name="shift12Tunda" min="0" step="1"></td>
                        <td><input type="number" name="shift12Sakit" min="0" step="1"></td>
                        <td><input type="number" name="shift12Izin" min="0" step="1"></td>
                        <td><input type="number" name="shift12CFV" min="0" step="1"></td>
                        <td><input type="number" name="shift12CL" min="0" step="1"></td>
                        <td><input type="number" name="shift12CT" min="0" step="1"></td>
                        <td><input type="number" name="shift12OFF" min="0" step="1"></td>
                    </tr>
                </tbody>
            </table>

            <button type="submit">Kirim Data</button>
        </form>

        <h2>Data Kehadiran</h2>
        <table id="attendanceTable">
            <thead>
                <tr>
                    <th>Tgl</th>
                    <th>ID</th>
                    <th>PT</th>
                    <th>Departement</th>
                    <th>Divisi</th>
                    <th>Nama Regu</th>
                    <th>Jenis Shift</th>
                    <th>Hadir</th>
                    <th>Absen Tunda</th>
                    <th>Sakit</th>
                    <th>Izin</th>
                    <th>CFV</th>
                    <th>CL</th>
                    <th>CT</th>
                    <th>OFF</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data akan diisi secara dinamis melalui JavaScript -->
            </tbody>
        </table>

        <button id="downloadButton">Download Excel</button>
    </div>

    <script>
        document.getElementById('attendanceForm').addEventListener('submit', function(e) {
            e.preventDefault();  // Mencegah form submit secara default

            // Ambil data dari form
            const formData = new FormData(this);
            const rowData = {
                date: formData.get('inputDate'),
                employeeId: formData.get('employeeId'),
                pt: formData.get('PT'),
                department: formData.get('Departemen'),
                division: formData.get('division'),
                team: formData.get('team'),
                shifts: [
                    { shiftType: 'Shift Reguler', absen: formData.get('shiftRegulerAbsen'), tunda: formData.get('shiftRegulerTunda'), sakit: formData.get('shiftRegulerSakit'), izin: formData.get('shiftRegulerIzin'), cfv: formData.get('shiftRegulerCFV'), cl: formData.get('shiftRegulerCL'), ct: formData.get('shiftRegulerCT'), off: formData.get('shiftRegulerOFF') },
                    { shiftType: '3 Shift 4 Regu', absen: formData.get('shift34Absen'), tunda: formData.get('shift34Tunda'), sakit: formData.get('shift34Sakit'), izin: formData.get('shift34Izin'), cfv: formData.get('shift34CFV'), cl: formData.get('shift34CL'), ct: formData.get('shift34CT'), off: formData.get('shift34OFF') },
                    { shiftType: '3 Shift 3 Regu', absen: formData.get('shift33Absen'), tunda: formData.get('shift33Tunda'), sakit: formData.get('shift33Sakit'), izin: formData.get('shift33Izin'), cfv: formData.get('shift33CFV'), cl: formData.get('shift33CL'), ct: formData.get('shift33CT'), off: formData.get('shift33OFF') },
                    { shiftType: '2 Shift 3 Regu', absen: formData.get('shift23Absen'), tunda: formData.get('shift23Tunda'), sakit: formData.get('shift23Sakit'), izin: formData.get('shift23Izin'), cfv: formData.get('shift23CFV'), cl: formData.get('shift23CL'), ct: formData.get('shift23CT'), off: formData.get('shift23OFF') },
                    { shiftType: '12 Jam Roster', absen: formData.get('shift12Absen'), tunda: formData.get('shift12Tunda'), sakit: formData.get('shift12Sakit'), izin: formData.get('shift12Izin'), cfv: formData.get('shift12CFV'), cl: formData.get('shift12CL'), ct: formData.get('shift12CT'), off: formData.get('shift12OFF') }
                ]
            };

            // Tambahkan data ke dalam tabel
            const table = document.querySelector('#attendanceTable tbody');
            rowData.shifts.forEach(shift => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${rowData.date}</td>
                    <td>${rowData.employeeId}</td>
                    <td>${rowData.pt}</td>
                    <td>${rowData.department}</td>
                    <td>${rowData.division}</td>
                    <td>${rowData.team}</td>
                    <td>${shift.shiftType}</td>
                    <td>${shift.absen}</td>
                    <td>${shift.tunda}</td>
                    <td>${shift.sakit}</td>
                    <td>${shift.izin}</td>
                    <td>${shift.cfv}</td>
                    <td>${shift.cl}</td>
                    <td>${shift.ct}</td>
                    <td>${shift.off}</td>
                `;
                table.appendChild(row);
            });
        });

        // Menangani download Excel
        document.getElementById('downloadButton').addEventListener('click', function() {
            const table = document.getElementById('attendanceTable');
            const wb = XLSX.utils.table_to_book(table, { sheet: "Attendance" });
            XLSX.writeFile(wb, "attendance_data.xlsx");
        });
    </script>
</body>
</html>
