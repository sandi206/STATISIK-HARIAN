<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STATISTIK HARIAN</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script> <!-- Added xlsx library -->
</head>
<body>
    <header>
        <h1>DATA STATISTIK HARIAN</h1>
    </header>

    <div class="container">
        <form id="attendanceForm">
            <!-- Input Tanggal Penginputan -->
            <label for="inputDate">Tanggal Penginputan:</label>
            <input type="date" id="inputDate" name="inputDate" required>

            <!-- Input ID Karyawan -->
            <label for="employeeId">ID Karyawan:</label>
            <input type="text" id="employeeId" name="employeeId" placeholder="Masukkan ID Karyawan" required>

            <label for="PT">PT</label>
            <select id="division" name="PT">
                <option value="PT A">CSP</option>
                <option value="PT B">LHMI</option>
                <option value="PT C">SMI</option>
            </select>

            <label for="department">Departemen</label>
            <select id="departemen" name="Departemen">
                <option value="dept A">PERAWATAN 1</option>
                <option value="dept B">PERAWATAN 2</option>
                <option value="dept C">PERAWATAN 3</option>
                <option value="dept D">Lainnya</option>
            </select>

            <label for="employeeDivision">Divisi:</label>
            <select id="employeeDivision" name="division">
                <option value="Divisi A">DESULFURISASI</option>
                <option value="Divisi B">ALAT</option>
                <option value="Divisi C">HSE</option>
                <option value="Divisi D">Lainnya</option>
            </select>

            <label for="team">Nama Regu:</label>
            <input type="text" id="team" name="team" placeholder="Masukkan Nama Regu dan Divisi jika tidak ada dalam list" required>

            <!-- Tabel untuk Jenis Shift dan Absensi -->
            <h3>Jenis Shift dan Absensi</h3>
            <table id="shiftTable">
                <thead>
                    <tr>
                        <th>Jenis Shift</th>
                        <th>Hadir</th> 
                        <th>Absen Tunda</th>
                        <th>Sakit</th>
                        <th>Izin</th>
                        <th>CFV</th>
                        <th>CL</th>
                        <th>CT</th>
                        <th>OFF</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Baris untuk Shift Reguler -->
                    <tr>
                        <td>Shift Reguler</td>
                        <td><input type="number" name="shiftRegulerAbsen" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerTunda" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerSakit" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerIzin" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerCFV" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerCL" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerCT" min="0" step="1"></td>
                        <td><input type="number" name="shiftRegulerOFF" min="0" step="1"></td>
                    </tr>
                </tbody>
            </table>

            <button type="submit">Kirim Data</button>
        </form>

        <h2>Data Kehadiran</h2>
        <table id="attendanceTable">
            <thead>
                <tr>
                    <th>Tanggal Penginputan</th>
                    <th>ID Karyawan</th>
                    <th>PT</th>
                    <th>Departemen</th>
                    <th>Divisi</th>
                    <th>Nama Regu</th>
                    <th>Jenis Shift</th>
                    <th>Jumlah Absen</th>
                    <th>Jumlah Tunda</th>
                    <th>CFV</th>
                    <th>CL</th>
                    <th>CT</th>
                    <th>OFF</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <button id="downloadButton">Download Data Excel</button>
    </div>

    <script>
        // Menangani pengisian form
        document.getElementById('attendanceForm').addEventListener('submit', function(e) {
            e.preventDefault();  // Mencegah form submit secara default

            // Ambil data dari form
            const formData = new FormData(this);
            const rowData = {
                date: formData.get('inputDate'),
                employeeId: formData.get('employeeId'),
                pt: formData.get('PT'),
                department: formData.get('Departemen'),
                division: formData.get('division'),
                team: formData.get('team'),
                shiftData: {
                    shiftRegulerAbsen: formData.get('shiftRegulerAbsen'),
                    shiftRegulerTunda: formData.get('shiftRegulerTunda'),
                    shiftRegulerSakit: formData.get('shiftRegulerSakit'),
                    shiftRegulerIzin: formData.get('shiftRegulerIzin'),
                    shiftRegulerCFV: formData.get('shiftRegulerCFV'),
                    shiftRegulerCL: formData.get('shiftRegulerCL'),
                    shiftRegulerCT: formData.get('shiftRegulerCT'),
                    shiftRegulerOFF: formData.get('shiftRegulerOFF'),
                }
            };

            // Tambahkan data ke dalam tabel
            const table = document.querySelector('#attendanceTable tbody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${rowData.date}</td>
                <td>${rowData.employeeId}</td>
                <td>${rowData.pt}</td>
                <td>${rowData.department}</td>
                <td>${rowData.division}</td>
                <td>${rowData.team}</td>
                <td>Shift Reguler</td>
                <td>${rowData.shiftData.shiftRegulerAbsen}</td>
                <td>${rowData.shiftData.shiftRegulerTunda}</td>
                <td>${rowData.shiftData.shiftRegulerCFV}</td>
                <td>${rowData.shiftData.shiftRegulerCL}</td>
                <td>${rowData.shiftData.shiftRegulerCT}</td>
                <td>${rowData.shiftData.shiftRegulerOFF}</td>
            `;
            table.appendChild(row);
        });

        // Menangani download Excel
        document.getElementById('downloadButton').addEventListener('click', function() {
            const table = document.getElementById('attendanceTable');
            const wb = XLSX.utils.table_to_book(table, {sheet: "Attendance"});
            XLSX.writeFile(wb, "attendance_data.xlsx");
        });
    </script>
</body>
</html>
